# ПРАКТИЧЕСКОЕ ЗАНЯТИЕ № 13

Упражнение 1. Получение справочной информации по командам

```cmd
ping /?
ipconfig /?
hostname /?
tracert /?
arp /?
route /?
netstat /?
nslookup
help
exit

Использование: ping [-t] [-a] [-n <число>] [-l <размер>] [-f] [-i <TTL>]
                    [-v <TOS>] [-r <число>] [-s <число>]
                    [[-j <список_узлов>] | [-k <список_узлов>]]
                    [-w <время_ожидания>] [-R] [-S <адрес_источника>]
                    [-c секция] [-p] [-4] [-6] конечный_узел

Параметры:
  -t                   Проверяет связь с указанным узлом до прекращения.
                       Для отображения статистики и продолжения проверки
                       нажмите клавиши CTRL+BREAK;
                       для прекращения нажмите CTRL+C.
  -a                   Разрешает адреса в имена узлов.
  -n <число>           Число отправляемых запросов проверки связи.
  -l <размер>          Размер буфера отправки.
  -f                   Устанавливает флаг, запрещающий фрагментацию,
                       в пакете (только IPv4).
  -i <TTL>             Срок жизни пакетов.
  -v <TOS>             Тип службы (только IPv4; этот параметр
                       использовать не рекомендуется, и он не влияет на поле
                       TOS в заголовке IP).
  -r <число>           Записывает маршрут для указанного числа прыжков
                       (только IPv4).
  -s <число>           Задает метку времени для указанного числа прыжков
                       (только IPv4)

...
```

Упражнение 2. Получение имени хоста

```cmd
C:\Users\andrn>hostname
Denis-pc
```

Упражнение 3. Изучение утилиты ipconfig

```cmd
ipconfig

Адаптер Ethernet Ethernet:

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::6001:6bc9:c1ee:a21%6
   IPv4-адрес. . . . . . . . . . . . : 192.168.0.4
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . : 192.168.0.1

Адаптер Ethernet vEthernet (WSL (Hyper-V firewall)):

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::8a06:2c6e:9feb:d4dc%34
   IPv4-адрес. . . . . . . . . . . . : 172.22.64.1
   Маска подсети . . . . . . . . . . : 255.255.240.0
   Основной шлюз. . . . . . . . . :

ipconfig /all

...

Адаптер Ethernet vEthernet (WSL (Hyper-V firewall)):

   DNS-суффикс подключения . . . . . :
   Описание. . . . . . . . . . . . . : Hyper-V Virtual Ethernet Adapter
   Физический адрес. . . . . . . . . : 00-15-5D-EE-CA-71
   DHCP включен. . . . . . . . . . . : Нет
   Автонастройка включена. . . . . . : Да
   Локальный IPv6-адрес канала . . . : fe80::8a06:2c6e:9feb:d4dc%34(Основной)
   IPv4-адрес. . . . . . . . . . . . : 172.22.64.1(Основной)
   Маска подсети . . . . . . . . . . : 255.255.240.0
   Основной шлюз. . . . . . . . . :
   IAID DHCPv6 . . . . . . . . . . . : 570430813
   DUID клиента DHCPv6 . . . . . . . : 00-01-00-01-2E-1C-C3-D3-D8-5E-D3-76-64-B9
   NetBios через TCP/IP. . . . . . . . : Включен

...
```

Упражнение 4. Тестирование связи с помощью утилиты ping

```cmd
ping 127.0.0.1
Обмен пакетами с 127.0.0.1 по с 32 байтами данных:
Ответ от 127.0.0.1: число байт=32 время<1мс TTL=128
Ответ от 127.0.0.1: число байт=32 время<1мс TTL=128
Ответ от 127.0.0.1: число байт=32 время<1мс TTL=128
Ответ от 127.0.0.1: число байт=32 время<1мс TTL=128

ping localhost
Обмен пакетами с Denis-pc [::1] с 32 байтами данных:
Ответ от ::1: время<1мс
Ответ от ::1: время<1мс
Ответ от ::1: время<1мс
Ответ от ::1: время<1мс

ping %COMPUTERNAME%
Обмен пакетами с Denis-pc [fe80::6001:6bc9:c1ee:a21%6] с 32 байтами данных:
Ответ от fe80::6001:6bc9:c1ee:a21%6: время<1мс
Ответ от fe80::6001:6bc9:c1ee:a21%6: время<1мс
Ответ от fe80::6001:6bc9:c1ee:a21%6: время<1мс
Ответ от fe80::6001:6bc9:c1ee:a21%6: время<1мс

ping 192.168.0.1 -n 5 -l 64
Обмен пакетами с 192.168.0.1 по с 64 байтами данных:
Ответ от 192.168.0.1: число байт=64 время<1мс TTL=64
Ответ от 192.168.0.1: число байт=64 время<1мс TTL=64
Ответ от 192.168.0.1: число байт=64 время<1мс TTL=64
Ответ от 192.168.0.1: число байт=64 время<1мс TTL=64
Ответ от 192.168.0.1: число байт=64 время<1мс TTL=64

ping google.com
Ответ от 64.233.161.102: число байт=32 время=31мс TTL=110
Ответ от 64.233.161.102: число байт=32 время=31мс TTL=110
Ответ от 64.233.161.102: число байт=32 время=31мс TTL=110
Ответ от 64.233.161.102: число байт=32 время=31мс TTL=110
```

Упражнение 5. Определение пути IP-пакета

```cmd
tracert yandex.ru

Трассировка маршрута к yandex.ru [5.255.255.77]
с максимальным числом прыжков 30:

  1    <1 мс    <1 мс    <1 мс  192.168.0.1
  2    <1 мс    <1 мс    <1 мс  100.64.24.89
  3     1 ms    <1 мс    <1 мс  91.232.188.17
  4    16 ms    16 ms    16 ms  marionetka.yndx.net [195.208.209.1]
  5    20 ms    19 ms    19 ms  10.32.21.1
  6    20 ms    21 ms    21 ms  10.3.1.1
  7    19 ms    18 ms    18 ms  yandex.ru [5.255.255.77]

Трассировка завершена.
```

Упражнение 6. Просмотр ARP-кэша

```cmd
arp -a
Интерфейс: 192.168.0.4 --- 0x6
  адрес в Интернете      Физический адрес      Тип
  192.168.0.1           40-ae-30-0d-8d-24     динамический
  192.168.0.120         a8-a1-59-fb-62-51     динамический
  192.168.0.255         ff-ff-ff-ff-ff-ff     статический
  224.0.0.2             01-00-5e-00-00-02     статический
  224.0.0.22            01-00-5e-00-00-16     статический
  224.0.0.251           01-00-5e-00-00-fb     статический
  224.0.0.252           01-00-5e-00-00-fc     статический
  239.255.255.250       01-00-5e-7f-ff-fa     статический
  255.255.255.255       ff-ff-ff-ff-ff-ff     статический

Интерфейс: 172.22.64.1 --- 0x22
  адрес в Интернете      Физический адрес      Тип
  172.22.78.135         00-15-5d-e3-44-d1     динамический
  172.22.79.255         ff-ff-ff-ff-ff-ff     статический
  224.0.0.2             01-00-5e-00-00-02     статический
  224.0.0.22            01-00-5e-00-00-16     статический
  224.0.0.251           01-00-5e-00-00-fb     статический
  239.255.255.250       01-00-5e-7f-ff-fa     статический

C:\Users\andrn>arp -s 192.168.1.100 00-11-22-33-44-55

C:\Users\andrn>arp -a

Интерфейс: 192.168.0.4 --- 0x6
  адрес в Интернете      Физический адрес      Тип
  192.168.0.1           40-ae-30-0d-8d-24     динамический
  192.168.0.120         a8-a1-59-fb-62-51     динамический
  192.168.0.255         ff-ff-ff-ff-ff-ff     статический
  224.0.0.2             01-00-5e-00-00-02     статический
  224.0.0.22            01-00-5e-00-00-16     статический
  224.0.0.251           01-00-5e-00-00-fb     статический
  224.0.0.252           01-00-5e-00-00-fc     статический
  239.255.255.250       01-00-5e-7f-ff-fa     статический
  255.255.255.255       ff-ff-ff-ff-ff-ff     статический

Интерфейс: 172.22.64.1 --- 0x22
  адрес в Интернете      Физический адрес      Тип
  172.22.78.135         00-15-5d-e3-44-d1     динамический
  172.22.79.255         ff-ff-ff-ff-ff-ff     статический
  192.168.1.100         00-11-22-33-44-55     статический
  224.0.0.2             01-00-5e-00-00-02     статический
  224.0.0.22            01-00-5e-00-00-16     статический
  224.0.0.251           01-00-5e-00-00-fb     статический
  239.255.255.250       01-00-5e-7f-ff-fa     статический

C:\Users\andrn>arp -d 192.168.1.100
```

Упражнение 7. Просмотр локальной таблицы маршрутизации

```cmd
C:\Users\andrn>route print
===========================================================================
Список интерфейсов
  6...d8 5e d3 76 64 b9 ......Realtek Gaming 2.5GbE Family Controller
  1...........................Software Loopback Interface 1
 34...00 15 5d ee ca 71 ......Hyper-V Virtual Ethernet Adapter
===========================================================================

IPv4 таблица маршрута
===========================================================================
Активные маршруты:
Сетевой адрес           Маска сети      Адрес шлюза       Интерфейс  Метрика
          0.0.0.0          0.0.0.0      192.168.0.1      192.168.0.4     25
        127.0.0.0        255.0.0.0         On-link         127.0.0.1    331
        127.0.0.1  255.255.255.255         On-link         127.0.0.1    331
  127.255.255.255  255.255.255.255         On-link         127.0.0.1    331
      172.22.64.0    255.255.240.0         On-link       172.22.64.1   5256
      172.22.64.1  255.255.255.255         On-link       172.22.64.1   5256
    172.22.79.255  255.255.255.255         On-link       172.22.64.1   5256
      192.168.0.0    255.255.255.0         On-link       192.168.0.4    281
      192.168.0.4  255.255.255.255         On-link       192.168.0.4    281
    192.168.0.255  255.255.255.255         On-link       192.168.0.4    281
        224.0.0.0        240.0.0.0         On-link         127.0.0.1    331
        224.0.0.0        240.0.0.0         On-link       192.168.0.4    281
        224.0.0.0        240.0.0.0         On-link       172.22.64.1   5256
  255.255.255.255  255.255.255.255         On-link         127.0.0.1    331
  255.255.255.255  255.255.255.255         On-link       192.168.0.4    281
  255.255.255.255  255.255.255.255         On-link       172.22.64.1   5256
===========================================================================
```

Упражнение 8. Получение информации о текущих сетевых соединениях

```cmd
C:\Users\andrn>netstat

Активные подключения

  Имя    Локальный адрес        Внешний адрес          Состояние
  TCP    127.0.0.1:5354         kubernetes:49671       ESTABLISHED
  TCP    127.0.0.1:5354         kubernetes:49672       ESTABLISHED
  TCP    127.0.0.1:10808        kubernetes:49354       ESTABLISHED
  TCP    127.0.0.1:10808        kubernetes:49682       TIME_WAIT
  TCP    127.0.0.1:10808        kubernetes:49943       ESTABLISHED
  TCP    127.0.0.1:10808        kubernetes:50089       ESTABLISHED
  TCP    127.0.0.1:10808        kubernetes:50137       ESTABLISHED
  ...

netstat -a      REM Показать все соединения и слушающие порты
netstat -s      REM Показать сетевую статистику по протоколам (TCP/UDP/ICMP/IP)
netstat -p udp  REM Показать только соединения и статистику по протоколу UDP
netstat -p tcp  REM Показать только соединения и статистику по протоколу TCP
netstat -p icmp REM Показать статистику ICMP (echo, timeout, unreachable и т.д.)
netstat -p ip   REM Показать статистику по IP: отправленные, полученные пакеты и ошибки
netstat -n      REM Показывать адреса и порты в числовом виде (без DNS-имен)
```

Упражнение 9. Получение DNS-информации с помощью nslookup

```cmd
nslookup
server 8.8.8.8
yandex.ru
set type=A
mail.ru
set type=NS
google.com
set type=SOA
microsoft.com
exit

C:\Users\andrn>nslookup yandex.ru
Address:  1.1.1.1

Не заслуживающий доверия ответ:
yandex.ru
Addresses:  2a02:6b8:a::a
          5.255.255.77
          77.88.44.55
          77.88.55.88


C:\Users\andrn>nslookup -type=NS google.com
one.one.one.one
Address:  1.1.1.1

Не заслуживающий доверия ответ:
google.com      nameserver = ns3.google.com
google.com      nameserver = ns2.google.com
google.com      nameserver = ns1.google.com
google.com      nameserver = ns4.google.com
```

Упражнение 10. Диагностика tcp-соединений с помощью утилиты telnet

```cmd
telnet google.com 443

C:\Users\andrn> nslookup -type=MX microsoft.com
╤хЁтхЁ:  one.one.one.one
Address:  1.1.1.1

Не заслуживающий доверия ответ:
microsoft.com   MX preference = 10, mail exchanger = microsoft-com.mail.protection.outlook.com

telnet microsoft-com.mail.protection.outlook.com 25
```

Дополнительные диагностические команды

```cmd
ipconfig /release       REM Отпустить текущий IP-адрес, выданный DHCP-сервером
ipconfig /renew         REM Запросить новый IP-адрес у DHCP-сервера
ipconfig /flushdns      REM Очистить локальный кэш DNS (удаляет устаревшие записи)
nbtstat -n              REM Показать NetBIOS-имена на локальной машине и их статус
netstat -b              REM Показать все активные TCP/UDP-соединения и связанные с ними исполняемые файлы (программы)
pathping google.com     REM Диагностика маршрута к хосту с показом потерь пакетов на каждом узле (комбинация ping + tracert)
```
